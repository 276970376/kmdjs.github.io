<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>从入门到精通</title>
</head>
<body>   
    <div style="text-align:center;"><canvas width="1728" id="ourCanvas" height="1152" style="border:0px solid #ccc;-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></canvas> 
         <div style="text-align:center;">
    
             <div style="display:none;"><img src="test1.png" alt="" />
                 <img src="test2.png" alt="" /><img src="test3.png" alt="" /><img src="test4.png" alt="" /><img src="test5.png" alt="" /><img src="test6.png" alt="" /><img src="test7.png" alt="" /><img src="test8.jpg" alt="" /><img src="test9.png" alt="" /><img src="test10.png" alt="" />
<img src="test13.png" alt="" /><img src="test11.png" alt="" /><img src="test12.png" alt="" /><img src="test14.png" alt="" /><img src="test15.png" alt="" />
             </div>
 </div>
    </div>

    <script>
        !function () {
            var e = !1, n = /xyz/.test(function () { }) ? /\b_super\b/ : /.*/, i = function () { }; i.extend = function (t) { function i() { !e && this.ctor && this.ctor.apply(this, arguments) } var r, s, o, a = this.prototype; e = !0, r = new this, e = !1; for (o in t) "statics" != o && (r[o] = "function" == typeof t[o] && "function" == typeof a[o] && n.test(t[o]) ? function (t, e) { return function () { var i, n = this._super; return this._super = a[t], i = e.apply(this, arguments), this._super = n, i } }(o, t[o]) : t[o]); for (s in this) this.hasOwnProperty(s) && "extend" != s && (i[s] = this[s]); if (i.prototype = r, t.statics) for (o in t.statics) t.statics.hasOwnProperty(o) && (i[o] = t.statics[o], "ctor" == o && i[o]()); return i.prototype.constructor = i, i.extend = arguments.callee, i.implement = function (t) { for (var e in t) r[e] = t[e] }, i }, function () {
                var t = {}, e = {}; t.FPS = i.extend({ statics: { get: function () { return this.instance || (this.instance = new this), this.instance._computeFPS(), this.instance.value } }, ctor: function () { this.last = new Date, this.current = null, this.value = 0, this.fpsList = []; var t = this; setInterval(function () { var e = t.fpsList.length - 1; t.value = t.fpsList[e], e > 500 && t.fpsList.shift() }, 500) }, _computeFPS: function () { this.current = new Date; var t = Math.ceil(1e3 / (this.current - this.last)); this.fpsList.push(t > 60 ? 60 : t), this.last = this.current } }), e.Main = i.extend({ ctor: function () { this.stage = new t.Stage("#ourCanvas"), this.stage.scalable(1, 1), this.pptConfig = { panels: [{ steps: [{ type: "text", value: "30分钟精通 kmdjs 和 arejs", y: 300 }, { type: "text", value: "dntzhang", x: 340 + this.stage.width / 2, y: 440, fontSize: 60 }], showEffect: "fade", hideEffect: "rotate" }, { steps: [{ type: "text", value: "requirejs作者", y: 200 }, { type: "image", value: "test5.png", y: 400 }], showEffect: "fade", hideEffect: "rotate" }, { steps: [{ type: "text", value: "programming javascript applications作者", y: 200, fontSize: 60 }, { type: "image", value: "test8.jpg", x: 250, y: 450 }, { type: "image", value: "test6.png", y: 400 }, { type: "image", value: "test7.png", y: 640 }], showEffect: "fade", hideEffect: "rotate" }, { steps: [{ type: "text", value: "当你想要一根香蕉的时候，却要为你准备一颗香蕉树~~", y: 400, fontSize: 60 }, { type: "text", value: "意思就是：面向对象需要付出额外的一些开销", y: 600, fontSize: 60 }, { type: "text", value: "jQuery这么火，你看人家只有extend，没有class的概念", y: 200, fontSize: 60 }], showEffect: "fade", hideEffect: "rotate" }, { steps: [{ type: "text", value: "???作者", y: 200 }, { type: "text", value: "太棒了！", y: 400, fontSize: 60 }, { type: "text", value: "太好用了！", y: 470, fontSize: 60 }, { type: "text", value: "太强大了！", y: 540, fontSize: 60 }, { type: "text", value: "我 =  =！", y: 320, fontSize: 200, color: "red" }], showEffect: "fade", hideEffect: "rotate" }, { steps: [{ type: "text", value: "Namespace.Class", y: 200, fontSize: 60 }, { type: "text", value: "Class是对某一物体或逻辑的抽象", y: 400, fontSize: 60 }, { type: "text", value: "Namespace是对Class进行分类", y: 600, fontSize: 60 }], showEffect: "fade", hideEffect: "rotate" }, { steps: [{ type: "text", value: "Module是什么", y: 200, fontSize: 60 }, { type: "text", value: "Module是对一类功能或逻辑的抽象", y: 400, fontSize: 60 }], showEffect: "fade", hideEffect: "rotate" }, { steps: [{ type: "text", value: "Module VS Class", y: 200, fontSize: 60 }, { type: "text", value: "Class是对某一物体或逻辑的抽象", y: 400, fontSize: 60 }, { type: "text", value: "Module是对一类功能或逻辑的抽象", y: 600, fontSize: 60 }], showEffect: "fade", hideEffect: "rotate" }, { steps: [{ type: "image", value: "test9.png" }], showEffect: "fade", hideEffect: "rotate" }, { steps: [{ type: "image", value: "test11.png" }], showEffect: "fade", hideEffect: "rotate" }, { steps: [{ type: "image", value: "test12.png" }], showEffect: "fade", hideEffect: "rotate" }, { steps: [{ type: "image", value: "test13.png" }], showEffect: "fade", hideEffect: "rotate" }, { steps: [{ type: "image", value: "test10.png" }], showEffect: "fade", hideEffect: "rotate" }, { steps: [{ type: "text", value: "命令", y: 200 }, { type: "image", value: "test2.png", y: 400 }, { type: "image", value: "test1.png" }], showEffect: "fade", hideEffect: "rotate" }, { steps: [{ type: "text", value: "命令", y: 200 }, { type: "image", value: "test14.png", y: 400 }, { type: "image", value: "test15.png", y: 600 }], showEffect: "fade", hideEffect: "rotate" }, { steps: [{ type: "text", value: "Q&A", fontSize: 100, y: 300 }, { type: "text", value: "谢谢", fontSize: 100 }], showEffect: "fade", hideEffect: "rotate" }], fullscreen: !0 }, this.pageIndex = 0, this.stepIndex = 0, this.totalPage = this.pptConfig.panels.length; var e = this; this.initPanels(), this.stage.onClick(function (t) { t.stageX > e.stage.width / 2 ? e.nextStep() : e.preStep() }), this.stage.onKeyboard("left", null, function () { e.preStep() }), this.stage.onKeyboard("right", null, function () { e.nextStep() }), this.updatePPT() }, updatePPT: function (t) { for (var e = 0; e < this.totalPage; e++) this.stage.children[e].visible = this.pageIndex !== e ? !1 : !0; for (var n = this.stage.children[this.pageIndex], i = n.children.length, a = 0; i > a; a++) t ? this.stepIndex === a ? this.randomEffect(n.children[a]) : n.children[a].visible = this.stepIndex > a ? !0 : !1 : n.children[a].visible = this.stepIndex >= a ? !0 : !1 }, initPanels: function () { for (var e = 0, n = this.pptConfig.panels.length; n > e; e++) { for (var i = this.pptConfig.panels[e], a = new t.Container, r = 0, s = i.steps.length; s > r; r++) { var o = i.steps[r]; if ("text" === o.type) { var h = new t.Text({ txt: o.value, fontSize: o.fontSize || 100, fontFamily: o.fontFamily || "arial", color: o.color || "black" }); h.originX = .5, h.originY = .5, h.x = "x" in o ? o.x : this.stage.width / 2, h.y = "y" in o ? o.y : this.stage.height / 2, h.visible = !1, a.add(h) } else if ("image" === o.type) { var c = new t.Bitmap(o.value); c.visible = !1, c.originX = .5, c.originY = .5, c.x = "x" in o ? o.x : this.stage.width / 2, c.y = "y" in o ? o.y : this.stage.height / 2, a.add(c) } } this.stage.add(a) } }, nextStep: function () { var t = this.pptConfig.panels[this.pageIndex].steps.length; if (this.stepIndex + 1 >= t) { if (this.pageIndex + 1 >= this.totalPage) return; this.stepIndex = 0, this.pageIndex++ } else this.stepIndex++; this.updatePPT(!0) }, preStep: function () { this.pptConfig.panels[this.pageIndex].steps.length; if (0 === this.stepIndex) { if (0 === this.pageIndex) return; this.pageIndex--, this.stepIndex = this.pptConfig.panels[this.pageIndex].steps.length - 1 } else this.stepIndex--; this.updatePPT() }, zoomIn: function (e) { e.visible = !1, t.To.get(e).to().scaleX(0, 0, t.To.elasticInOut).scaleY(0, 0, t.To.elasticInOut).end(function () { e.visible = !0 }).to().scaleX(1, 1400, t.To.elasticInOut).scaleY(1, 1400, t.To.elasticInOut).start() }, slideInRight: function (e) { var n = e.x; e.visible = !1, t.To.get(e).to().x(this.stage.width + e.width, 0, t.To.elasticInOut).end(function () { e.visible = !0 }).to().x(n, 1400, t.To.elasticInOut).start() }, lightSpeedIn: function (e) { var n = e.x; e.visible = !1, t.To.get(e).to().x(-1 * e.width, 0, t.To.elasticInOut).skewX(-30, 0).end(function () { e.visible = !0 }).to().x(n, 1e3).to().skewX(20, 200).to().skewX(-10, 200).to().skewX(0, 200).start() }, slideInBottom: function (e) { var n = e.y; e.visible = !1, t.To.get(e).to().y(this.stage.height + e.height, 0, t.To.elasticInOut).end(function () { e.visible = !0 }).to().y(n, 1400, t.To.elasticInOut).start() }, fadeIn: function (e) { e.visible = !1, t.To.get(e).to().alpha(0, 0, t.To.elasticInOut).end(function () { e.visible = !0 }).to().alpha(1, 1400, t.To.elasticInOut).start() }, rotateIn: function (e) { e.visible = !1, t.To.get(e).to().alpha(.5, 0, t.To.elasticInOut).scaleX(0, 0).scaleY(0, 0).end(function () { e.visible = !0 }).to().alpha(1, 1400, t.To.elasticInOut).rotation(720, 1400).scaleX(1, 1400).scaleY(1, 1400).start() }, randomEffect: function (t) { var e = ["zoomIn", "slideInRight", "slideInBottom", "fadeIn", "rotateIn", "rotateIn", "lightSpeedIn", "lightSpeedIn"]; this[e[Math.floor(e.length * Math.random())]](t) } }), t.DisplayObject = i.extend({ ctor: function () { this.alpha = this.scaleX = this.scaleY = 1, this.x = this.y = this.rotation = this.originX = this.originY = this.skewX = this.skewY = this.width = this.height = this.regX = this.regY = 0, this.flipX = this.flipY = !1, this.textureReady = !0, this.visible = !0, this._matrix = new t.Matrix2D, this.events = {}, this.id = t.UID.get(), this.cacheID = 0, this.inner = !0, this.baseInstanceof = "DisplayObject"; var e = this; this._watch(this, "originX", function (t, n) { e.regX = e.width * n }), this._watch(this, "originY", function (t, n) { e.regY = e.height * n }); var e = this; this._watch(this, "filter", function (t, n) { e.setFilter.apply(e, n) }) }, _watch: function (t, e, n) { t["__" + e] = this[e]; Object.defineProperty(t, e, { get: function () { return this["__" + e] }, set: function (t) { this["__" + e] = t, n(e, t) } }) }, isVisible: function () { return !!(this.visible && this.alpha > 0 && 0 != this.scaleX && 0 != this.scaleY && this.inner && this.textureReady) }, on: function (t, e) { this.events[t] || (this.events[t] = []), this.events[t].push(e) }, execEvent: function (t) { var e = this.events[t], n = !0; if (e) for (var i = 0, a = e.length; a > i; i++) n = e[i].call(this); return n }, hover: function (t, e) { this.on("mouseover", t), this.on("mouseout", e) }, clone: function () { var e = new t.DisplayObject; return this.cloneProps(e), e }, cloneProps: function (t) { t.visible = this.visible, t.alpha = this.alpha, t.originX = this.originX, t.originY = this.originY, t.rotation = this.rotation, t.scaleX = this.scaleX, t.scaleY = this.scaleY, t.skewX = this.skewX, t.skewY = this.skewY, t.x = this.x, t.y = this.y, t.regX = this.regX, t.regY = this.regY }, cache: function () { if (!this.cacheCanvas) { this.cacheCanvas = document.createElement("canvas"); var e = this.getBound(); this.cacheCanvas.width = e.width, this.cacheCanvas.height = e.height, this.cacheCtx = this.cacheCanvas.getContext("2d") } this.cacheID = t.UID.getCacheID(), t.Stage.renderer.updateCache(this.cacheCtx, this, e.width, e.width) }, uncache: function () { this.cacheCanvas = null, this.cacheCtx = null, this.cacheID = null }, setFilter: function (t, e, n, i) { if (0 !== this.width && 0 !== this.height) { this.uncache(), this.cache(); for (var a = this.cacheCtx.getImageData(0, 0, this.cacheCanvas.width, this.cacheCanvas.height), r = a.data, s = 0, o = r.length; o > s; s += 4) r[s + 3] > 0 && (r[s] *= t, r[s + 1] *= e, r[s + 2] *= n, r[s + 3] *= i); this.cacheCtx.putImageData(a, 0, 0) } }, getBound: function () { return { width: this.width, height: this.height } }, toCenter: function () { this.originX = .5, this.originY = .5, this.x = this.parent.width / 2, this.y = this.parent.height / 2 }, onClick: function (t) { this.on("click", t) }, onMouseMove: function (t) { this.on("mousemove", t) }, destroy: function () { this.cacheCanvas = null, this.cacheCtx = null, this.cacheID = null, this._matrix = null, this.events = null, this.parent && this.parent.remove(this) }, getAABB: function () { if (0 === this.rotation) { var e = this.width * this.scaleX, n = this.height * this.scaleY, i = [this.x - e * this.originX, this.y - n * this.originY, e, n]; return this.parent instanceof t.Container ? this.parent.superimposeAABB(i) : i } }, superimposeAABB: function (e) { if (0 === this.rotation) { var n = e[2] * this.scaleX, i = e[3] * this.scaleY, a = [this.x + e[0] - e[0] * (1 - this.scaleX), this.y + e[1] - e[1] * (1 - this.scaleY), n, i]; return this.parent instanceof t.Container ? this.parent.superimposeAABB(a) : a } }, getTransformedAABB: function () { } }), t.Bitmap = t.DisplayObject.extend({ ctor: function (t) { this._super(), 0 !== arguments.length && ("string" == typeof t ? this._initWithSrc(t) : this._init(t)) }, _initWithSrc: function (e) { var n = t.Bitmap[e]; if (n) this._init(n); else { var i = this; this.textureReady = !1, this.img = document.createElement("img"), this.img.onload = function () { i.rect || (i.rect = [0, 0, i.img.width, i.img.height]), i.width = i.rect[2], i.height = i.rect[3], i.regX = i.width * i.originX, i.regY = i.height * i.originY, t.Bitmap[e] = i.img, i.textureReady = !0, i.imageLoadHandle && i.imageLoadHandle(), i.filter && (i.filter = i.filter) }, this.img.src = e } }, _init: function (t) { t && (this.img = t, this.width = t.width, this.height = t.height, Object.defineProperty(this, "rect", { get: function () { return this.__rect }, set: function (t) { this.__rect = t, this.width = t[2], this.height = t[3], this.regX = t[2] * this.originX, this.regY = t[3] * this.originY } }), this.rect = [0, 0, t.width, t.height]) }, useImage: function (t) { "string" == typeof t ? this._initWithSrc(t) : (this._init(t), this.imageLoadHandle && this.imageLoadHandle()) }, onImageLoad: function (t) { this.imageLoadHandle = t }, clone: function () { var e = new t.Bitmap(this.img); return e.rect = this.rect.slice(0), this.cloneProps(e), e } }), t.Text = t.DisplayObject.extend({ ctor: function (e) { this._super(), this.txt = e.txt, this.fontSize = e.fontSize, this.fontFamily = e.fontFamily, this.color = e.color, this.textAlign = "center", this.textBaseline = "top", this.maxWidth = e.maxWidth || 2e3, this.square = e.square || !1, this.txtCanvas = document.createElement("canvas"), this.txtCtx = this.txtCanvas.getContext("2d"); var n = this.getDrawOption({ txt: this.txt, maxWidth: this.maxWidth, square: this.square, size: this.fontSize, alignment: this.textAlign, color: this.color || "black", fontFamily: this.fontFamily }); this.cacheID = t.UID.getCacheID(), this.width = n.calculatedWidth, this.height = n.calculatedHeight }, getDrawOption: function (t) { { var i, a, r, s, e = this.txtCanvas, n = this.txtCtx, o = [], h = t.txt, c = t.maxWidth, u = t.square, l = t.size, f = t.alignment, d = t.color, p = t.fontFamily; t.backgroundColour } switch (n.font = l + "px " + p, c && this.measureText(n, h) > c ? (c = this.createMultilineText(n, h, c, o), i = this.getPowerOfTwo(c)) : (o.push(h), i = this.getPowerOfTwo(n.measureText(h).width)), a = this.getPowerOfTwo(l * (o.length + 1)), u && (i > a ? a = i : i = a), t.calculatedWidth = i, t.calculatedHeight = a, e.width = i, e.height = a, f) { case "left": r = 0; break; case "center": r = i / 2; break; case "right": r = i } s = a / 2, n.fillStyle = d, n.textAlign = f, n.textBaseline = "middle", n.font = l + "px " + p; var m = .5 * (a - l * (o.length + 1)); t.cmd = []; for (var v = 0; v < o.length; v++) o.length > 1 && (s = (v + 1) * l + m), t.cmd.push({ text: o[v], x: r, y: s }), n.fillText(o[v], r, s); return t }, getPowerOfTwo: function (t, e) { for (var e = e || 1; t > e;) e *= 2; return e }, measureText: function (t, e) { return t.measureText(e).width }, createMultilineText: function (t, e, n, i) { e = e.replace("\n", " "); var r, c, u, a = e, s = 0, o = 0, h = e.split(" "); for (c = u = h.length; this.measureText(t, a) > n && c > 1;) { c--; a = r = ""; for (var f = 0; u > f; f++) c > f ? (a += h[f], c > f + 1 && (a += " ")) : (r += h[f], u > f + 1 && (r += " ")) } return i.push(a), o = this.measureText(t, a), r && (s = this.createMultilineText(t, r, n, i), s > o && (o = s)), o }, draw: function (t) { t.fillStyle = this.color, t.font = this.font, t.textAlign = this.textAlign || "left", t.textBaseline = this.textBaseline || "top", t.fillText(this.text, 0, 0) }, clone: function () { var e = new t.Text(this.text, this.font, this.color); return this.cloneProps(e), e } }), t.To = i.extend({ statics: { mappingTWEEN: function () { this.bounceOut = t.TWEEN.Easing.Bounce.Out, this.linear = t.TWEEN.Easing.Linear.None, this.quadraticIn = t.TWEEN.Easing.Quadratic.In, this.quadraticOut = t.TWEEN.Easing.Quadratic.Out, this.quadraticInOut = t.TWEEN.Easing.Quadratic.InOut, this.cubicIn = t.TWEEN.Easing.Cubic.In, this.cubicOut = t.TWEEN.Easing.Cubic.Out, this.cubicInOut = t.TWEEN.Easing.Cubic.InOut, this.quarticIn = t.TWEEN.Easing.Quartic.In, this.quarticOut = t.TWEEN.Easing.Quartic.Out, this.quarticInOut = t.TWEEN.Easing.Quartic.InOut, this.quinticIn = t.TWEEN.Easing.Quintic.In, this.quinticOut = t.TWEEN.Easing.Quintic.Out, this.quinticInOut = t.TWEEN.Easing.Quintic.InOut, this.sinusoidalIn = t.TWEEN.Easing.Sinusoidal.In, this.sinusoidalOut = t.TWEEN.Easing.Sinusoidal.Out, this.sinusoidalInOut = t.TWEEN.Easing.Sinusoidal.InOut, this.exponentialIn = t.TWEEN.Easing.Exponential.In, this.exponentialOut = t.TWEEN.Easing.Exponential.Out, this.exponentialInOut = t.TWEEN.Easing.Exponential.InOut, this.circularIn = t.TWEEN.Easing.Circular.In, this.circularOut = t.TWEEN.Easing.Circular.Out, this.circularInOut = t.TWEEN.Easing.Circular.InOut, this.elasticIn = t.TWEEN.Easing.Elastic.In, this.elasticOut = t.TWEEN.Easing.Elastic.Out, this.elasticInOut = t.TWEEN.Easing.Elastic.InOut, this.backIn = t.TWEEN.Easing.Back.In, this.backOut = t.TWEEN.Easing.Back.Out, this.backInOut = t.TWEEN.Easing.Back.InOut, this.bounceIn = t.TWEEN.Easing.Bounce.In, this.bounceOut = t.TWEEN.Easing.Bounce.Out, this.bounceInOut = t.TWEEN.Easing.Bounce.InOut, this.interpolationLinear = t.TWEEN.Interpolation.Linear, this.interpolationBezier = t.TWEEN.Interpolation.Bezier, this.interpolationCatmullRom = t.TWEEN.Interpolation.CatmullRom }, get: function (t) { return this.bounceOut || this.mappingTWEEN(), new this(t) } }, ctor: function (e) { this.element = e, this.cmds = [], this.index = 0, this.loop = setInterval(function () { t.TWEEN.update() }, 15), this.cycleCount = 0 }, to: function () { return this.cmds.push(["to"]), this }, x: function () { return this.cmds[this.cmds.length - 1].push(["x", arguments]), this }, y: function () { return this.cmds[this.cmds.length - 1].push(["y", arguments]), this }, z: function () { return this.cmds[this.cmds.length - 1].push(["z", arguments]), this }, rotation: function () { return this.cmds[this.cmds.length - 1].push(["rotation", arguments]), this }, scaleX: function () { return this.cmds[this.cmds.length - 1].push(["scaleX", arguments]), this }, scaleY: function () { return this.cmds[this.cmds.length - 1].push(["scaleY", arguments]), this }, skewX: function () { return this.cmds[this.cmds.length - 1].push(["skewX", arguments]), this }, skewY: function () { return this.cmds[this.cmds.length - 1].push(["skewY", arguments]), this }, originX: function () { return this.cmds[this.cmds.length - 1].push(["originX", arguments]), this }, originY: function () { return this.cmds[this.cmds.length - 1].push(["originY", arguments]), this }, alpha: function () { return this.cmds[this.cmds.length - 1].push(["alpha", arguments]), this }, begin: function (t) { return this.cmds[this.cmds.length - 1].begin = t, this }, progress: function (t) { return this.cmds[this.cmds.length - 1].progress = t, this }, end: function (t) { return this.cmds[this.cmds.length - 1].end = t, this }, wait: function () { return this.cmds.push(["wait", arguments]), this }, then: function () { return this.cmds.push(["then", arguments]), this }, cycle: function () { return this.cmds.push(["cycle", arguments]), this }, shake: function () { return this.cmds = this.cmds.concat([["to", ["x", { 0: 10, 1: 50 }]], ["to", ["x", { 0: -10, 1: 50 }]], ["to", ["x", { 0: 10, 1: 50 }]], ["to", ["x", { 0: -10, 1: 50 }]], ["to", ["x", { 0: 10, 1: 50 }]], ["to", ["x", { 0: -10, 1: 50 }]], ["to", ["x", { 0: 10, 1: 50 }]], ["to", ["x", { 0: -10, 1: 50 }]], ["to", ["x", { 0: 10, 1: 50 }]], ["to", ["x", { 0: -10, 1: 50 }]], ["to", ["x", { 0: 10, 1: 50 }]], ["to", ["x", { 0: 0, 1: 50 }]]]), this }, rubber: function () { return this.cmds = this.cmds.concat([["to", ["scaleX", { 0: 1.25, 1: 300 }], ["scaleY", { 0: .75, 1: 300 }]], ["to", ["scaleX", { 0: .75, 1: 100 }], ["scaleY", { 0: 1.25, 1: 100 }]], ["to", ["scaleX", { 0: 1.15, 1: 100 }], ["scaleY", { 0: .85, 1: 100 }]], ["to", ["scaleX", { 0: .95, 1: 150 }], ["scaleY", { 0: 1.05, 1: 150 }]], ["to", ["scaleX", { 0: 1.05, 1: 100 }], ["scaleY", { 0: .95, 1: 100 }]], ["to", ["scaleX", { 0: 1, 1: 250 }], ["scaleY", { 0: 1, 1: 250 }]]]), this }, bounceIn: function () { return this.cmds = this.cmds.concat([["to", ["scaleX", { 0: 0, 1: 0 }], ["scaleY", { 0: 0, 1: 0 }]], ["to", ["scaleX", { 0: 1.35, 1: 200 }], ["scaleY", { 0: 1.35, 1: 200 }]], ["to", ["scaleX", { 0: .9, 1: 100 }], ["scaleY", { 0: .9, 1: 100 }]], ["to", ["scaleX", { 0: 1.1, 1: 100 }], ["scaleY", { 0: 1.1, 1: 100 }]], ["to", ["scaleX", { 0: .95, 1: 100 }], ["scaleY", { 0: .95, 1: 100 }]], ["to", ["scaleX", { 0: 1, 1: 100 }], ["scaleY", { 0: 1, 1: 100 }]]]), this }, flipInX: function () { return this.cmds = this.cmds.concat([["to", ["rotateX", { 0: -90, 1: 0 }]], ["to", ["rotateX", { 0: 20, 1: 300 }]], ["to", ["rotateX", { 0: -20, 1: 300 }]], ["to", ["rotateX", { 0: 10, 1: 300 }]], ["to", ["rotateX", { 0: -5, 1: 300 }]], ["to", ["rotateX", { 0: 0, 1: 300 }]]]), this }, zoomOut: function () { return this.cmds = this.cmds.concat([["to", ["scaleX", { 0: 0, 1: 400 }], ["scaleY", { 0: 0, 1: 400 }]]]), this }, start: function () { var t = this.cmds.length; this.index < t ? this.exec(this.cmds[this.index], this.index == t - 1) : clearInterval(this.loop) }, exec: function (e, n) { var i = e.length, a = this; switch (e[0]) { case "to": for (var r = 1; i > r; r++) { var s = e[r], o = s[1][2], h = {}, c = s[0]; h[c] = s[1][0]; { new t.TWEEN.Tween(this.element).to(h, s[1][1]).onStart(function () { e.start && e.start() }).onUpdate(function () { e.progress && e.progress(), a.element[c] = this[c] }).easing(o ? o : t.To.linear).onComplete(function (t) { return function () { t == i - 1 && (e.end && e.end(), n && a.complete && a.complete(), a.index++, a.start()) } }(r)).start() } } break; case "wait": setTimeout(function () { a.index++, a.start(), n && a.complete && a.complete() }, e[1][0]); break; case "then": var l = e[1][0]; l.index = 0, l.complete = function () { a.index++, a.start(), n && a.complete && a.complete() }, l.start(); break; case "cycle": var f = e[1][1]; f && a.cycleCount == f ? (a.index++, a.start(), n && a.complete && a.complete()) : (a.cycleCount++, a.index = e[1][0], a.start()) } } }), t.Container = t.DisplayObject.extend({ ctor: function () { this._super(), this.children = [], this.baseInstanceof = "Container" }, add: function (t) { var e = arguments.length; if (e > 1) for (var n = 0; e > n; n++) { var i = arguments[n]; i && (this.children.push(i), i.parent = this) } else t && (this.children.push(t), t.parent = this) }, remove: function (t) { var e = arguments.length, n = this.children.length; if (e > 1) { for (var i = 0; e > i; i++) for (var a = arguments[i], r = n; --r >= 0;) if (this.children[r].id == a.id) { a.parent = null, this.children.splice(r, 1); break } } else for (var s = n; --s >= 0;) if (this.children[s].id == t.id) { t.parent = null, this.children.splice(s, 1); break } }, clone: function () { var e = new t.Container; this.cloneProps(e); for (var n = e.children = [], i = this.children.length - 1; i > -1; i--) { var a = this.children[i].clone(); n.unshift(a) } return e }, removeAll: function () { for (var t = this.children; t.length;) t.pop().parent = null }, destroy: function () { this._super(); for (var t = this.children; t.length;) { var e = t.pop(); e.destroy() } } }), t.Stage = t.Container.extend({ ctor: function (e, n) { this._super(), this.canvas = "string" == typeof e ? document.querySelector(e) : e, this.width = this.canvas.width, this.height = this.canvas.height, this.AABB = [0, 0, this.width, this.height]; var a = (!!window.CanvasRenderingContext2D, function () { try { var t = document.createElement("canvas"); return !(!window.WebGLRenderingContext || !t.getContext("webgl") && !t.getContext("experimental-webgl")) } catch (e) { return !1 } }()); a && !n ? this.renderer = new t.WebGLRenderer(this) : (this.ctx = this.canvas.getContext("2d"), this.renderer = new t.CanvasRenderer(this)), t.Stage.renderer = this.renderer, this.hitRenderer = new t.CanvasRenderer(this), this.hitCanvas = document.createElement("canvas"), this.hitCanvas.width = 1, this.hitCanvas.height = 1, this.hitCtx = this.hitCanvas.getContext("2d"), this._scaleX = this._scaleY = null, this.offset = this._getXY(this.canvas), this.overObj = null, this.pause = !1, this.fps = 63, this.interval = Math.floor(1e3 / this.fps); var r = this; r.loop = setInterval(function () { r._tick(r) }, r.interval), Object.defineProperty(this, "useRequestAnimFrame", { set: function (e) { this._useRequestAnimFrame = e, e ? (clearInterval(r.loop), r.loop = t.RAF.requestInterval(function () { r._tick(r) }, r.interval)) : (t.RAF.clearRequestInterval(r.loop), r.loop = setInterval(function () { r._tick(r) }, r.interval)) }, get: function () { return this._useRequestAnimFrame } }), this.domSurface = document.createElement("div"); var s = this.domSurface.style; s.width = this.width + "px", s.height = this.height + "px", s.backgroundColor = "rgba(255,255,255,0)", s.zIndex = 1003, s.position = "absolute", s.border = "0px solid red", s.left = this.offset[0] + "px", s.top = this.offset[1] + "px", document.body.appendChild(this.domSurface), this.domSurface.addEventListener("mousemove", this._handleMouseMove.bind(this), !1), this.domSurface.addEventListener("click", this._handleClick.bind(this), !1), this.innerObjectCount = 0, this.debugDiv = document.createElement("div"), this.debugDiv.style.cssText = "display:none;position:absolute;z-index:1000;left:0;top:0;background-color:yellow;font-size:20px;", document.body.appendChild(this.debugDiv), Object.defineProperty(this, "debug", { set: function (t) { this._debug = t, this.debugDiv.style.display = this._debug ? "block" : "none" }, get: function () { return this._debug } }) }, add: function (e) { this._super.apply(this, arguments); var n, i = arguments.length; for (n = 0; i > n; n++) { var e = arguments[n]; e instanceof t.DomElement && this.domSurface.appendChild(e.element) } }, update: function () { this.pause || (this.hideOuterObject(this), this.renderer.update()) }, _handleClick: function (t) { if (t.stageX = t.pageX - this.offset[0], t.stageY = t.pageY - this.offset[1], this._scaleX) { var e = this.correctingXY(t.stageX, t.stageY); t.stageX = Math.round(e.x), t.stageY = Math.round(e.y) } var n = this.events.click; if (n) for (var i = 0, a = n.length; a > i; i++) { var r = n[i]; r(t) } this.hitRenderer.hitRender(this.hitCtx, this, null, t.stageX, t.stageY, "click") }, _handleMouseMove: function (t) { if (t.stageX = t.pageX - this.offset[0], t.stageY = t.pageY - this.offset[1], this._scaleX) { var e = this.correctingXY(t.stageX, t.stageY); t.stageX = Math.round(e.x), t.stageY = Math.round(e.y) } var n = this.events.mousemove; if (n) for (var i = 0, a = n.length; a > i; i++) { var r = n[i]; r(t) } }, _getXY: function (t) { var e = 0, n = 0; if (!document.documentElement.getBoundingClientRect || !t.getBoundingClientRect) { for (; t.offsetParent;) e += t.offsetTop, n += t.offsetLeft, t = t.offsetParent; return [n, e] } var i = t.getBoundingClientRect(); return n = i.left, e = i.top, [n + Math.max(document.documentElement.scrollLeft, document.body.scrollLeft), e + Math.max(document.documentElement.scrollTop, document.body.scrollTop)] }, destroy: function () { }, _tick: function (t) { if (t && t.tick) if (this._initInterval(t), t.hasOwnProperty("_tickInterval")) { t._tickIntervalCurrent = new Date, t._tickIntervalLast || (t._tickIntervalLast = new Date); var e = t._tickIntervalCurrent - t._tickIntervalLast; 2 * e > t._tickInterval && (t.tick(), t._tickIntervalLast = t._tickIntervalCurrent) } else t.tick(); for (var n = t.children, i = n.length, a = 0; i > a; a++) { var r = n[a]; if (r) { if (r.tick) if (this._initInterval(r), r.hasOwnProperty("_tickInterval")) { r._tickIntervalCurrent = new Date, r._tickIntervalLast || (r._tickIntervalLast = new Date); var e = r._tickIntervalCurrent - r._tickIntervalLast; 2 * e > r._tickInterval && (r.tick(), r._tickIntervalLast = r._tickIntervalCurrent) } else r.tick(); "Container" == r.baseInstanceof && this._tick(r) } } }, _initInterval: function (t) { t.hasOwnProperty("tickFPS") && (t._tickInterval = 0 == t.tickFPS ? 1e4 : 1e3 / t.tickFPS) }, tick: function () { this.tickFn && this.tickFn(), this.update(), this.debug && (this.debugDiv.innerHTML = "fps : " + this.getFPS() + " <br/>object count : " + this.getTotalCount() + " <br/>rendering mode : " + this.getRenderingMode() + " <br/>inner object count  : " + this.innerObjectCount) }, onTick: function (t) { this.tickFn = t }, setFPS: function (t) { this.interval = Math.floor(1e3 / t) }, onKeyboard: function (e, n, i) { t.Keyboard.on(e, n, i) }, getActiveKeys: function () { return t.Keyboard.getActiveKeys() }, scalable: function (t, e) { 1 === t && 1 === e && (document.body.style.overflow = "hidden", document.documentElement.style.overflow = "hidden"), document.body.style.margin = 0, document.documentElement.style.margin = 0, document.body.style.border = 0, document.documentElement.style.border = 0, document.body.style.padding = 0, document.documentElement.style.padding = 0, document.body.style.width = "100%", document.documentElement.style.width = "100%", document.body.style.height = "100%", document.documentElement.style.height = "100%", this._scaleX = t, this._scaleY = e; var n = this.canvas; n.style.position = "absolute", n.style.width = 100 * t + "%", n.style.height = 100 * e + "%", n.style.left = 100 * (1 - t) / 2 + "%", n.style.top = 100 * (1 - e) / 2 + "%", n.style.border = "0px solid #ccc"; var i = this.domSurface; i.style.position = "absolute", i.style.width = 100 * t + "%", i.style.height = 100 * e + "%", i.style.left = 100 * (1 - t) / 2 + "%", i.style.top = 100 * (1 - e) / 2 + "%", i.style.border = "0px solid #ccc", i.style.transform = i.style.msTransform = i.style.OTransform = i.style.MozTransform = i.style.webkitTransform = "scale(" + this._scaleX + "," + this._scaleY + ")", this.offset = this._getXY(this.canvas) }, correctingXY: function (t, e) { return { x: t * this.width / (window.innerWidth * this._scaleX), y: e * this.height / (window.innerHeight * this._scaleY) } }, getTotalCount: function () { function i(a) { if ("Container" == a.baseInstanceof) for (var r = 0, s = a.children.length; s > r; r++) { var o = a.children[r]; o instanceof t.Container ? i(o) : (e++, o.inner && n.innerObjectCount++) } else e++ } var e = 0; this.innerObjectCount = 0; var n = this; return i(this), e }, getRenderingMode: function () { return this.renderer instanceof t.CanvasRenderer ? "Canvas" : "WebGL" }, getFPS: function () { return t.FPS.get() }, hideOuterObject: function (e) { for (var n = 0, i = e.children.length; i > n; n++) { var a = e.children[n]; a instanceof t.Container ? this.hideOuterObject(a) : a.inner = this.isInStage(a) } }, isInStage: function (t) { var e = t.getAABB(); return e ? this.collisionBetweenAABB(e, this.AABB) : !0 }, collisionBetweenAABB: function (t, e) { var n = t[0] + t[2]; if (n < e[0]) return !1; var i = t[0]; if (i > e[0] + e[2]) return !1; var a = t[1] + t[3]; if (a < e[1]) return !1; var a = t[1]; return a > e[1] + e[3] ? !1 : !0 } }), t.UID = i.extend({ statics: { _nextID: 0, _nextCacheID: 1, get: function () { return this._nextID++ }, getCacheID: function () { return this._nextCacheID++ } } }), t.TWEEN = i.extend({
                    statics: {
                        ctor: function () { void 0 === Date.now && (Date.now = function () { return (new Date).valueOf() }), this._tweens = [] }, REVISION: "14", getAll: function () { return this._tweens }, removeAll: function () { this._tweens = [] }, add: function (t) { this._tweens.push(t) }, remove: function (t) { var e = this._tweens.indexOf(t); -1 !== e && this._tweens.splice(e, 1) }, update: function (t) { if (0 === this._tweens.length) return !1; var e = 0; for (t = void 0 !== t ? t : "undefined" != typeof window && void 0 !== window.performance && void 0 !== window.performance.now ? window.performance.now() : Date.now() ; e < this._tweens.length;) this._tweens[e].update(t) ? e++ : this._tweens.splice(e, 1); return !0 }, Tween: function (e) { var n = e, i = {}, a = {}, r = {}, s = 1e3, o = 0, h = !1, c = !1, u = !1, l = 0, f = null, d = t.TWEEN.Easing.Linear.None, p = t.TWEEN.Interpolation.Linear, g = [], m = null, v = !1, w = null, y = null, x = null, b = !1, E = null; for (var C in e) i[C] = parseFloat(e[C], 10); this.togglePlayPause = function () { b ? this.play() : this.pause() }, this.pause = function () { b = !0; var t = "undefined" != typeof window && void 0 !== window.performance && void 0 !== window.performance.now ? window.performance.now() : Date.now(); E = t - f }, this.play = function () { b = !1; var t = "undefined" != typeof window && void 0 !== window.performance && void 0 !== window.performance.now ? window.performance.now() : Date.now(); f = t - E }, this.to = function (t, e) { return void 0 !== e && (s = e), a = t, this }, this.start = function (e) { t.TWEEN.add(this), c = !0, v = !1, f = void 0 !== e ? e : "undefined" != typeof window && void 0 !== window.performance && void 0 !== window.performance.now ? window.performance.now() : Date.now(), f += l; for (var s in a) { if (a[s] instanceof Array) { if (0 === a[s].length) continue; a[s] = [n[s]].concat(a[s]) } i[s] = n[s], i[s] instanceof Array == !1 && (i[s] *= 1), r[s] = i[s] || 0 } return this }, this.stop = function () { return c ? (t.TWEEN.remove(this), c = !1, null !== x && x.call(n), this.stopChainedTweens(), this) : this }, this.stopChainedTweens = function () { for (var t = 0, e = g.length; e > t; t++) g[t].stop() }, this.delay = function (t) { return l = t, this }, this.repeat = function (t) { return o = t, this }, this.yoyo = function (t) { return h = t, this }, this.easing = function (t) { return d = t, this }, this.interpolation = function (t) { return p = t, this }, this.chain = function () { return g = arguments, this }, this.onStart = function (t) { return m = t, this }, this.onUpdate = function (t) { return w = t, this }, this.onComplete = function (t) { return y = t, this }, this.onStop = function (t) { return x = t, this }, this.update = function (t) { if (b) return !0; var e; if (f > t) return !0; v === !1 && (null !== m && m.call(n), v = !0); var c = (t - f) / s; c = c > 1 ? 1 : c; var x = d(c); for (e in a) { var E = i[e] || 0, C = a[e]; C instanceof Array ? n[e] = p(C, x) : ("string" == typeof C && (C = E + parseFloat(C, 10)), "number" == typeof C && (n[e] = E + (C - E) * x)) } if (null !== w && w.call(n, x), 1 == c) { if (o > 0) { isFinite(o) && o--; for (e in r) { if ("string" == typeof a[e] && (r[e] = r[e] + parseFloat(a[e], 10)), h) { var T = r[e]; r[e] = a[e], a[e] = T } i[e] = r[e] } return h && (u = !u), f = t + l, !0 } null !== y && y.call(n); for (var I = 0, _ = g.length; _ > I; I++) g[I].start(t); return !1 } return !0 } }, Easing: {
                            Linear: { None: function (t) { return t } }, Quadratic: { In: function (t) { return t * t }, Out: function (t) { return t * (2 - t) }, InOut: function (t) { return (t *= 2) < 1 ? .5 * t * t : -.5 * (--t * (t - 2) - 1) } }, Cubic: { In: function (t) { return t * t * t }, Out: function (t) { return --t * t * t + 1 }, InOut: function (t) { return (t *= 2) < 1 ? .5 * t * t * t : .5 * ((t -= 2) * t * t + 2) } }, Quartic: { In: function (t) { return t * t * t * t }, Out: function (t) { return 1 - --t * t * t * t }, InOut: function (t) { return (t *= 2) < 1 ? .5 * t * t * t * t : -.5 * ((t -= 2) * t * t * t - 2) } }, Quintic: { In: function (t) { return t * t * t * t * t }, Out: function (t) { return --t * t * t * t * t + 1 }, InOut: function (t) { return (t *= 2) < 1 ? .5 * t * t * t * t * t : .5 * ((t -= 2) * t * t * t * t + 2) } }, Sinusoidal: { In: function (t) { return 1 - Math.cos(t * Math.PI / 2) }, Out: function (t) { return Math.sin(t * Math.PI / 2) }, InOut: function (t) { return .5 * (1 - Math.cos(Math.PI * t)) } }, Exponential: { In: function (t) { return 0 === t ? 0 : Math.pow(1024, t - 1) }, Out: function (t) { return 1 === t ? 1 : 1 - Math.pow(2, -10 * t) }, InOut: function (t) { return 0 === t ? 0 : 1 === t ? 1 : (t *= 2) < 1 ? .5 * Math.pow(1024, t - 1) : .5 * (-Math.pow(2, -10 * (t - 1)) + 2) } }, Circular: { In: function (t) { return 1 - Math.sqrt(1 - t * t) }, Out: function (t) { return Math.sqrt(1 - --t * t) }, InOut: function (t) { return (t *= 2) < 1 ? -.5 * (Math.sqrt(1 - t * t) - 1) : .5 * (Math.sqrt(1 - (t -= 2) * t) + 1) } }, Elastic: { In: function (t) { var e, n = .1, i = .4; return 0 === t ? 0 : 1 === t ? 1 : (!n || 1 > n ? (n = 1, e = i / 4) : e = i * Math.asin(1 / n) / (2 * Math.PI), -(n * Math.pow(2, 10 * (t -= 1)) * Math.sin(2 * (t - e) * Math.PI / i))) }, Out: function (t) { var e, n = .1, i = .4; return 0 === t ? 0 : 1 === t ? 1 : (!n || 1 > n ? (n = 1, e = i / 4) : e = i * Math.asin(1 / n) / (2 * Math.PI), n * Math.pow(2, -10 * t) * Math.sin(2 * (t - e) * Math.PI / i) + 1) }, InOut: function (t) { var e, n = .1, i = .4; return 0 === t ? 0 : 1 === t ? 1 : (!n || 1 > n ? (n = 1, e = i / 4) : e = i * Math.asin(1 / n) / (2 * Math.PI), (t *= 2) < 1 ? -.5 * n * Math.pow(2, 10 * (t -= 1)) * Math.sin(2 * (t - e) * Math.PI / i) : n * Math.pow(2, -10 * (t -= 1)) * Math.sin(2 * (t - e) * Math.PI / i) * .5 + 1) } }, Back: { In: function (t) { var e = 1.70158; return t * t * ((e + 1) * t - e) }, Out: function (t) { var e = 1.70158; return --t * t * ((e + 1) * t + e) + 1 }, InOut: function (t) { var e = 2.5949095; return (t *= 2) < 1 ? .5 * t * t * ((e + 1) * t - e) : .5 * ((t -= 2) * t * ((e + 1) * t + e) + 2) } }, Bounce: {
                                In: function (e) { return 1 - t.TWEEN.Easing.Bounce.Out(1 - e) }, Out: function (t) { return 1 / 2.75 > t ? 7.5625 * t * t : 2 / 2.75 > t ? 7.5625 * (t -= 1.5 / 2.75) * t + .75 : 2.5 / 2.75 > t ? 7.5625 * (t -= 2.25 / 2.75) * t + .9375 : 7.5625 * (t -= 2.625 / 2.75) * t + .984375 }, InOut: function (e) {
                                    return .5 > e ? .5 * t.TWEEN.Easing.Bounce.In(2 * e) : .5 * t.TWEEN.Easing.Bounce.Out(2 * e - 1) + .5
                                }
                            }
                        }, Interpolation: { Linear: function (e, n) { var i = e.length - 1, a = i * n, r = Math.floor(a), s = t.TWEEN.Interpolation.Utils.Linear; return 0 > n ? s(e[0], e[1], a) : n > 1 ? s(e[i], e[i - 1], i - a) : s(e[r], e[r + 1 > i ? i : r + 1], a - r) }, Bezier: function (e, n) { var o, i = 0, a = e.length - 1, r = Math.pow, s = t.TWEEN.Interpolation.Utils.Bernstein; for (o = 0; a >= o; o++) i += r(1 - n, a - o) * r(n, o) * e[o] * s(a, o); return i }, CatmullRom: function (e, n) { var i = e.length - 1, a = i * n, r = Math.floor(a), s = t.TWEEN.Interpolation.Utils.CatmullRom; return e[0] === e[i] ? (0 > n && (r = Math.floor(a = i * (1 + n))), s(e[(r - 1 + i) % i], e[r], e[(r + 1) % i], e[(r + 2) % i], a - r)) : 0 > n ? e[0] - (s(e[0], e[0], e[1], e[1], -a) - e[0]) : n > 1 ? e[i] - (s(e[i], e[i], e[i - 1], e[i - 1], a - i) - e[i]) : s(e[r ? r - 1 : 0], e[r], e[r + 1 > i ? i : r + 1], e[r + 2 > i ? i : r + 2], a - r) }, Utils: { Linear: function (t, e, n) { return (e - t) * n + t }, Bernstein: function (e, n) { var i = t.TWEEN.Interpolation.Utils.getFactorial(); return i(e) / i(n) / i(e - n) }, getFactorial: function () { return function () { var t = [1]; return function (e) { var i, n = 1; if (t[e]) return t[e]; for (i = e; i > 1; i--) n *= i; return t[e] = n } }() }, CatmullRom: function (t, e, n, i, a) { var r = .5 * (n - t), s = .5 * (i - e), o = a * a, h = a * o; return (2 * e - 2 * n + r + s) * h + (-3 * e + 3 * n - 2 * r - s) * o + r * a + e } } }
                    }
                }), t.WebGLRenderer = i.extend({ ctor: function (e) { this.root = e, this.surface = e.canvas, this.snapToPixel = !0, this.canvasRenderer = new t.CanvasRenderer, this.textureCache = {}, this.textureCanvasCache = {}, this.initSurface(this.surface) }, initSurface: function (t) { var e = { depth: !1, alpha: !0, preserveDrawingBuffer: !0, antialias: !1, premultipliedAlpha: !0 }, n = void 0; try { n = t.ctx = t.getContext("webgl", e) || t.getContext("experimental-webgl", e), n.viewportWidth = t.width, n.viewportHeight = t.height } catch (i) { } n || alert("Could not initialise WebGL. Make sure you've updated your browser, or try a different one like Google Chrome."); var a = n.createShader(n.FRAGMENT_SHADER); n.shaderSource(a, "precision mediump float;\nvarying vec3 vTextureCoord;\nvarying float vAlpha;\nuniform float uAlpha;\nuniform sampler2D uSampler0;\nvoid main(void) { \nvec4 color = texture2D(uSampler0, vTextureCoord.st);  \ngl_FragColor = vec4(color.rgb, color.a * vAlpha);\n}"), n.compileShader(a), n.getShaderParameter(a, n.COMPILE_STATUS) || alert(n.getShaderInfoLog(a)); var r = n.createShader(n.VERTEX_SHADER); n.shaderSource(r, "attribute vec2 aVertexPosition;\nattribute vec3 aTextureCoord;\nattribute float aAlpha;\nuniform bool uSnapToPixel;\nconst mat4 pMatrix = mat4(" + 2 / n.viewportWidth + ",0,0,0, 0," + -2 / n.viewportHeight + ",0,0, 0,0,-2,   0, -1,1,-1,1); \nvarying vec3 vTextureCoord;\nvarying float vAlpha;\nvoid main(void) { \nvTextureCoord = aTextureCoord; \nvAlpha = aAlpha; \ngl_Position = pMatrix * vec4(aVertexPosition.x,aVertexPosition.y,0.0, 1.0);\n}"), n.compileShader(r), n.getShaderParameter(r, n.COMPILE_STATUS) || alert(n.getShaderInfoLog(r)); var s = t.shader = n.createProgram(); n.attachShader(s, r), n.attachShader(s, a), n.linkProgram(s), n.getProgramParameter(s, n.LINK_STATUS) || alert("Could not initialise shaders"), n.enableVertexAttribArray(s.vertexPositionAttribute = n.getAttribLocation(s, "aVertexPosition")), n.enableVertexAttribArray(s.uvCoordAttribute = n.getAttribLocation(s, "aTextureCoord")), n.enableVertexAttribArray(s.colorAttribute = n.getAttribLocation(s, "aAlpha")), s.alphaUniform = n.getUniformLocation(s, "uAlpha"), s.snapToUniform = n.getUniformLocation(s, "uSnapToPixel"), n.useProgram(s), this._vertexDataCount = 5, this._root2 = Math.sqrt(2), this._index = 0, this._cacheTextures = [], this._degToRad = Math.PI / 180, this.vertices = window.Float32Array ? new window.Float32Array(4 * this._vertexDataCount * 5e3) : new Array(4 * this._vertexDataCount * 5e3), this.arrayBuffer = n.createBuffer(), this.indexBuffer = n.createBuffer(), n.bindBuffer(n.ARRAY_BUFFER, this.arrayBuffer), n.bindBuffer(n.ELEMENT_ARRAY_BUFFER, this.indexBuffer); var o = 4 * this._vertexDataCount; n.vertexAttribPointer(s.vertexPositionAttribute, 2, n.FLOAT, 0, o, 0), n.vertexAttribPointer(s.uvCoordAttribute, 2, n.FLOAT, 0, o, 8), n.vertexAttribPointer(s.colorAttribute, 1, n.FLOAT, 0, o, 16), this.indices = window.Uint16Array ? new window.Uint16Array(3e4) : new Array(3e4); for (var h = 0, c = this.indices.length; c > h; h += 6) { var u = 4 * h / 6; this.indices.set([u, u + 1, u + 2, u, u + 2, u + 3], h) } n.bufferData(n.ARRAY_BUFFER, this.vertices, n.STREAM_DRAW), n.bufferData(n.ELEMENT_ARRAY_BUFFER, this.indices, n.STATIC_DRAW), n.viewport(0, 0, n.viewportWidth, n.viewportHeight), n.colorMask(!0, !0, !0, !0), n.blendFuncSeparate(n.SRC_ALPHA, n.ONE_MINUS_SRC_ALPHA, n.SRC_ALPHA, n.ONE), n.enable(n.BLEND), n.disable(n.DEPTH_TEST), t.init = !0 }, _initTexture: function (t, e) { this.textureCache[t.src] ? (t.glTexture = this.textureCache[t.src], e.activeTexture(e.TEXTURE0), e.bindTexture(e.TEXTURE_2D, t.glTexture)) : (t.glTexture = e.createTexture(), t.glTexture.image = t, e.activeTexture(e.TEXTURE0), e.bindTexture(e.TEXTURE_2D, t.glTexture), e.texImage2D(e.TEXTURE_2D, 0, e.RGBA, e.RGBA, e.UNSIGNED_BYTE, t.glTexture.image), e.texParameteri(e.TEXTURE_2D, e.TEXTURE_MAG_FILTER, e.LINEAR), e.texParameteri(e.TEXTURE_2D, e.TEXTURE_MIN_FILTER, e.LINEAR), e.texParameteri(e.TEXTURE_2D, e.TEXTURE_WRAP_S, e.CLAMP_TO_EDGE), e.texParameteri(e.TEXTURE_2D, e.TEXTURE_WRAP_T, e.CLAMP_TO_EDGE), this.textureCache[t.src] = t.glTexture, e.uniform1i(e.getUniformLocation(e.canvas.shader, "uSampler0"), 0)) }, _initCache: function (t, e, n) { this.textureCanvasCache[t.cacheID] ? (e.glTexture = this.textureCanvasCache[t.cacheID], n.activeTexture(n.TEXTURE0), n.bindTexture(n.TEXTURE_2D, e.glTexture)) : (e.glTexture = n.createTexture(), e.glTexture.image = e, n.activeTexture(n.TEXTURE0), n.bindTexture(n.TEXTURE_2D, e.glTexture), n.texImage2D(n.TEXTURE_2D, 0, n.RGBA, n.RGBA, n.UNSIGNED_BYTE, e.glTexture.image), n.texParameteri(n.TEXTURE_2D, n.TEXTURE_MAG_FILTER, n.LINEAR), n.texParameteri(n.TEXTURE_2D, n.TEXTURE_MIN_FILTER, n.LINEAR), n.texParameteri(n.TEXTURE_2D, n.TEXTURE_WRAP_S, n.CLAMP_TO_EDGE), n.texParameteri(n.TEXTURE_2D, n.TEXTURE_WRAP_T, n.CLAMP_TO_EDGE), n.uniform1i(n.getUniformLocation(n.canvas.shader, "uSampler0"), 0), this.textureCanvasCache[t.cacheID] = e.glTexture) }, render: function (t, e) { var n = e.ctx; n.clear(n.COLOR_BUFFER_BIT), this._render(n, t) }, _getCompositeOperation: function (t) { return t.compositeOperation ? t.compositeOperation : t.parent ? this._getCompositeOperation(t.parent) : void 0 }, _getAlpha: function (t, e) { var n = t.alpha * e; return t.parent ? this._getAlpha(t.parent, n) : n }, _render: function (e, n, i) { if (n.isVisible()) { if (n instanceof t.DomElement) return void (n.element.style.display = "block"); var a = n._matrix, r = 0, s = 0, o = 0, h = 0; a = (i ? a.copy(i) : a.identity()).appendTransform(n.x, n.y, n.scaleX, n.scaleY, n.rotation, n.skewX, n.skewY, n.regX, n.regY); var c = 0, u = 0, l = 1, f = 1, d = 0, p = this._getCompositeOperation(n); "lighter" === p ? e.blendFunc(e.SRC_ALPHA, e.ONE) : e.blendFunc(e.SRC_ALPHA, e.ONE_MINUS_SRC_ALPHA); var g = n.cacheCanvas || n.txtCanvas || n.shapeCanvas; if (g) this._initCache(n, g, e), o = r + g.width, h = s + g.height; else { if (n instanceof t.Container) { for (var m = n.children, v = 0, w = m.length; w > v; v++) this._render(e, m[v], a); return } if (n instanceof t.Bitmap || n instanceof t.Sprite) { var y = n.rect; d = n.img, this._initTexture(d, e), o = r + y[2], h = s + y[3], l = y[2] / d.width, f = y[3] / d.height, c = y[0] / d.width, u = y[1] / d.height } } var x = a.a, b = a.b, E = a.c, C = a.d, T = a.tx, I = a.ty, _ = r * x, k = r * b, A = s * E, O = s * C, R = o * x, S = o * b, X = h * E, D = h * C, P = this._getAlpha(n, 1); this.vertices.set([_ + A + T, k + O + I, c, u, P, _ + X + T, k + D + I, c, u + f, P, R + X + T, S + D + I, c + l, u + f, P, R + A + T, S + O + I, c + l, u, P], this._index * this._vertexDataCount), this._index += 4, this._draw(e) } }, _draw: function (t) { t.bufferSubData(t.ARRAY_BUFFER, 0, this.vertices.subarray(0, this._index * this._vertexDataCount)), t.drawElements(t.TRIANGLES, 1.5 * this._index, t.UNSIGNED_SHORT, 0), this._index = 0 }, update: function () { this.render(this.root, this.surface) }, updateCache: function (t, e, n, i) { t.clearRect(0, 0, n + 1, i + 1), this.renderCache(t, e) }, renderCache: function (e, n) { if (n.isVisible()) if (n instanceof t.Container || n instanceof t.Stage) for (var i = n.children.slice(0), a = 0, r = i.length; r > a; a++) e.save(), this.canvasRenderer.render(e, i[a]), e.restore(); else if (n instanceof t.Bitmap || n instanceof t.Sprite) { var s = n.rect; e.drawImage(n.img, s[0], s[1], s[2], s[3], 0, 0, s[2], s[3]) } else n.txtCanvas ? e.drawImage(n.txtCanvas, 0, 0) : n.shapeCanvas && e.drawImage(n.shapeCanvas, 0, 0) } }), t.RAF = i.extend({ statics: { ctor: function () { var t = function () { return window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.oRequestAnimationFrame || window.msRequestAnimationFrame || function (t) { window.setTimeout(t, 1e3 / 60) } }(), e = function (e, n) { function r() { var s = (new Date).getTime(), o = s - i; o >= n && (e.call(), i = (new Date).getTime()), a.value = t(r) } if (!(window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame && window.mozCancelRequestAnimationFrame || window.oRequestAnimationFrame || window.msRequestAnimationFrame)) return window.setInterval(e, n); var i = (new Date).getTime(), a = new Object; return a.value = t(r), a }, n = function (t) { t && setTimeout(function () { window.cancelAnimationFrame ? window.cancelAnimationFrame(t.value) : window.webkitCancelAnimationFrame ? window.webkitCancelAnimationFrame(t.value) : window.webkitCancelRequestAnimationFrame ? window.webkitCancelRequestAnimationFrame(t.value) : window.mozCancelRequestAnimationFrame ? window.mozCancelRequestAnimationFrame(t.value) : window.oCancelRequestAnimationFrame ? window.oCancelRequestAnimationFrame(t.value) : window.msCancelRequestAnimationFrame ? window.msCancelRequestAnimationFrame(t.value) : clearInterval(t) }, 0) }; this.requestInterval = e, this.clearRequestInterval = n } } }), t.CanvasRenderer = i.extend({ ctor: function (t) { t && (this.stage = t, this.ctx = t.ctx, this.height = t.width, this.width = t.height) }, update: function () { this.ctx.clearRect(0, 0, this.height, this.width), this.render(this.ctx, this.stage) }, render: function (e, n, i) { if (n.isVisible()) { if (n instanceof t.DomElement) return void (n.element.style.display = "block"); i ? n._matrix.reinitialize(i.a, i.b, i.c, i.d, i.tx, i.ty, i.alpha, i.shadow, i.compositeOperation) : n._matrix.reinitialize(1, 0, 0, 1, 0, 0), i = n._matrix, i.appendTransform(n.x, n.y, n.scaleX, n.scaleY, n.rotation, n.skewX, n.skewY, n.regX, n.regY, n.filpX, n.flipY); var a = e.globalAlpha, r = e.globalCompositeOperation; e.globalAlpha *= n.alpha, e.globalCompositeOperation = n.compositeOperation; var s = n.cacheCanvas || n.txtCanvas || n.shapeCanvas; if (s) e.setTransform(i.a, i.b, i.c, i.d, i.tx, i.ty), e.drawImage(s, 0, 0); else if (n instanceof t.Container || n instanceof t.Stage) for (var o = n.children.slice(0), h = 0, c = o.length; c > h; h++) e.save(), this.render(e, o[h], i), e.restore(); else if (n instanceof t.Bitmap || n instanceof t.Sprite) { var u = n.rect; e.setTransform(i.a, i.b, i.c, i.d, i.tx, i.ty), e.drawImage(n.img, u[0], u[1], u[2], u[3], 0, 0, u[2], u[3]) } e.globalAlpha = a, e.globalCompositeOperation = r } }, hitRender: function (t, e, n, i, a, r) { n ? e._matrix.reinitialize(n.a, n.b, n.c, n.d, n.tx, n.ty, n.alpha, n.shadow, n.compositeOperation) : e._matrix.reinitialize(1, 0, 0, 1, 0, 0), n = e._matrix, n.appendTransform(e.x, e.y, e.scaleX, e.scaleY, e.rotation, e.skewX, e.skewY, e.regX, e.regY, e.filpX, e.flipY); for (var s = e.children.slice(0), o = s.length, h = o - 1; h >= 0; h--) { var c = s[h]; n.reinitialize(1, 0, 0, 1, 0, 0), n.appendTransform(e.x - i, e.y - a, e.scaleX, e.scaleY, e.rotation, e.skewX, e.skewY, e.regX, e.regY, e.filpX, e.flipY); var c = s[h]; this.isbindingEvent(c) && (t.save(), this._hitRender(t, s[h], n, r), t.restore()) } }, _hitRender: function (e, n, i, a) { if (e.clearRect(0, 0, 2, 2), n.isVisible()) { i ? n._matrix.reinitialize(i.a, i.b, i.c, i.d, i.tx, i.ty, i.alpha, i.shadow, i.compositeOperation) : n._matrix.reinitialize(1, 0, 0, 1, 0, 0), i = n._matrix, i.appendTransform(n.x, n.y, n.scaleX, n.scaleY, n.rotation, n.skewX, n.skewY, n.regX, n.regY, n.filpX, n.flipY); var r = e.globalAlpha; e.globalAlpha *= n.alpha; var s = n.cacheCanvas || n.txtCanvas || n.shapeCanvas; if (s) e.setTransform(i.a, i.b, i.c, i.d, i.tx, i.ty), e.drawImage(s, 0, 0); else if (n instanceof t.Container) for (var o = n.children.slice(0), h = o.length, c = h - 1; c >= 0; c--) { { o[c] } e.save(), this._hitRender(e, o[c], i, a), e.restore() } else if (n instanceof t.Bitmap || n instanceof t.Sprite) { var l = n.rect; e.setTransform(i.a, i.b, i.c, i.d, i.tx, i.ty), e.drawImage(n.img, l[0], l[1], l[2], l[3], 0, 0, l[2], l[3]) } e.getImageData(0, 0, 1, 1).data[3] > 1 && !(n instanceof t.Container) && this._bubbleEvent(n, a), e.globalAlpha = r } }, _bubbleEvent: function (t, e) { var n = t.execEvent(e); n !== !1 && t.parent && t.parent.events[e] && t.parent.events[e].length > 0 && this._bubbleEvent(t.parent, e) }, isbindingEvent: function (e) { if (0 !== Object.keys(e.events).length) return !0; if (e instanceof t.Container) for (var n = 0, i = e.children.length; i > n; n++) { var a = e.children[n]; if (a instanceof t.Container) return this.isbindingEvent(a); if (0 !== Object.keys(a.events).length) return !0 } return !1 }, updateCache: function (t, e, n, i) { t.clearRect(0, 0, n + 1, i + 1), this.renderCache(t, e) }, renderCache: function (e, n) { if (n.isVisible()) if (n instanceof t.Container || n instanceof t.Stage) for (var i = n.children.slice(0), a = 0, r = i.length; r > a; a++) e.save(), this.render(e, i[a]), e.restore(); else if (n instanceof t.Bitmap || n instanceof t.Sprite) { var s = n.rect; e.drawImage(n.img, s[0], s[1], s[2], s[3], 0, 0, s[2], s[3]) } else n.txtCanvas ? e.drawImage(n.txtCanvas, 0, 0) : n.shapeCanvas && e.drawImage(n.shapeCanvas, 0, 0) } }), t.DomElement = t.DisplayObject.extend({ ctor: function (e) { this._super(), this.element = "string" == typeof e ? document.querySelector(e) : e; var i = (this.element, t.Observable.watch(this, ["x", "y", "scaleX", "scaleY", "perspective", "rotation", "skewX", "skewY", "regX", "regY"])), a = this; i.propertyChangedHandler = function () { var t = a._matrix.identity().appendTransform(a.x, a.y, a.scaleX, a.scaleY, a.rotation, a.skewX, a.skewY, a.regX, a.regY); a.element.style.transform = a.element.style.msTransform = a.element.style.OTransform = a.element.style.MozTransform = a.element.style.webkitTransform = "matrix(" + t.a + "," + t.b + "," + t.c + "," + t.d + "," + t.tx + "," + t.ty + ")" }, delete this.visible, Object.defineProperty(this, "visible", { set: function (t) { this._visible = t, this.element.style.display = this._visible ? "block" : "none" }, get: function () { return this._visible } }), delete this.alpha, Object.defineProperty(this, "alpha", { set: function (t) { this._opacity = t, this.element.style.opacity = t }, get: function () { return this._opacity } }), this.visible = !0, this.alpha = 1, this.element.style.display = "none" }, isVisible: function () { return !!(this.visible && this.alpha > 0 && 0 != this.scaleX && 0 != this.scaleY) } }), t.Matrix2D = i.extend({ statics: { DEG_TO_RAD: .017453292519943295 }, ctor: function (t, e, n, i, a, r) { return this.a = null == t ? 1 : t, this.b = e || 0, this.c = n || 0, this.d = null == i ? 1 : i, this.tx = a || 0, this.ty = r || 0, this }, identity: function () { return this.a = this.d = 1, this.b = this.c = this.tx = this.ty = 0, this }, appendTransform: function (e, n, i, a, r, s, o, h, c, u, l) { if (r % 360) var f = r * t.Matrix2D.DEG_TO_RAD, d = Math.cos(f), p = Math.sin(f); else d = 1, p = 0; return s || o ? (s *= t.Matrix2D.DEG_TO_RAD, o *= t.Matrix2D.DEG_TO_RAD, this.append(Math.cos(o), Math.sin(o), -Math.sin(s), Math.cos(s), e, n), this.append(d * i, p * i, -p * a, d * a, 0, 0)) : this.append(d * i, p * i, -p * a, d * a, e, n), (h || c) && (this.tx -= h * this.a + c * this.c, this.ty -= h * this.b + c * this.d), u && (this.a *= -1, this.c *= -1), l && (this.b *= -1, this.d *= -1), this }, append: function (t, e, n, i, a, r) { var s = this.a, o = this.b, h = this.c, c = this.d; return this.a = t * s + e * h, this.b = t * o + e * c, this.c = n * s + i * h, this.d = n * o + i * c, this.tx = a * s + r * h + this.tx, this.ty = a * o + r * c + this.ty, this }, reinitialize: function (t, e, n, i, a, r, s, o, h) { return this.initialize(t, e, n, i, a, r), this.alpha = s || 1, this.shadow = o, this.compositeOperation = h, this }, initialize: function (t, e, n, i, a, r) { return null != t && (this.a = t), this.b = e || 0, this.c = n || 0, null != i && (this.d = i), this.tx = a || 0, this.ty = r || 0, this }, setValues: function (t, e, n, i, a, r) { return this.a = null == t ? 1 : t, this.b = e || 0, this.c = n || 0, this.d = null == i ? 1 : i, this.tx = a || 0, this.ty = r || 0, this }, copy: function (t) { return this.setValues(t.a, t.b, t.c, t.d, t.tx, t.ty) } }), t.Keyboard = i.extend({ statics: { ctor: function () { function l() { window.addEventListener ? (window.document.addEventListener("keydown", p, !1), window.document.addEventListener("keyup", g, !1), window.addEventListener("blur", d, !1), window.addEventListener("webkitfullscreenchange", d, !1), window.addEventListener("mozfullscreenchange", d, !1)) : window.attachEvent && (window.document.attachEvent("onkeydown", p), window.document.attachEvent("onkeyup", g), window.attachEvent("onblur", d)) } function f() { d(), window.removeEventListener ? (window.document.removeEventListener("keydown", p, !1), window.document.removeEventListener("keyup", g, !1), window.removeEventListener("blur", d, !1), window.removeEventListener("webkitfullscreenchange", d, !1), window.removeEventListener("mozfullscreenchange", d, !1)) : window.detachEvent && (window.document.detachEvent("onkeydown", p), window.document.detachEvent("onkeyup", g), window.detachEvent("onblur", d)) } function d(t) { r = [], b(), _(t) } function p(t) { var e, n, i; if (e = m(t.keyCode), !(e.length < 1)) { for (t.isRepeat = !1, i = 0; i < e.length; i += 1) n = e[i], -1 != X().indexOf(n) && (t.isRepeat = !0), D(n); x(), I(t) } } function g(t) { var e, n; if (e = m(t.keyCode), !(e.length < 1)) { for (n = 0; n < e.length; n += 1) P(e[n]); b(), _(t) } } function m(t) { return i[t] || [] } function v(t) { var e; for (e in i) if (i.hasOwnProperty(e) && i[e].indexOf(t) > -1) return e; return !1 } function w(t, e) { if ("string" != typeof t && ("object" != typeof t || "function" != typeof t.push)) throw new Error("Cannot create macro. The combo must be a string or array."); if ("object" != typeof e || "function" != typeof e.push) throw new Error("Cannot create macro. The injectedKeys must be an array."); a.push([t, e]) } function y(t) { var e, n; if ("string" != typeof t && ("object" != typeof t || "function" != typeof t.push)) throw new Error("Cannot remove macro. The combo must be a string or array."); for (n = 0; n < a.length; n += 1) if (e = a[n], k(t, e[0])) { P(e[1]), a.splice(n, 1); break } } function x() { var t, e, n; for (t = 0; t < a.length; t += 1) if (e = R(a[t][0]), -1 === h.indexOf(a[t]) && A(e)) for (h.push(a[t]), n = 0; n < a[t][1].length; n += 1) D(a[t][1][n]) } function b() { var t, e, n; for (t = 0; t < h.length; t += 1) if (e = R(h[t][0]), A(e) === !1) { for (n = 0; n < h[t][1].length; n += 1) P(h[t][1][n]); h.splice(t, 1), t -= 1 } } function E(t, e, n) { function u() { var t; for (t = 0; t < r.length; t += 1) s.splice(s.indexOf(r[t]), 1) } function l(t) { function s() { var e, i; for (e = 0; e < n.length; e += 1) if ("function" == typeof n[e]) if ("keyup" === t) for (i = 0; i < r.length; i += 1) r[i].keyUpCallback.splice(r[i].keyUpCallback.indexOf(n[e]), 1); else for (i = 0; i < r.length; i += 1) r[i].keyDownCallback.splice(r[i].keyDownCallback.indexOf(n[e]), 1) } var n, i, a, e = {}; if ("string" != typeof t) throw new Error("Cannot bind callback. The event name must be a string."); if ("keyup" !== t && "keydown" !== t) throw new Error('Cannot bind callback. The event name must be a "keyup" or "keydown".'); for (n = Array.prototype.slice.apply(arguments, [1]), i = 0; i < n.length; i += 1) if ("function" == typeof n[i]) if ("keyup" === t) for (a = 0; a < r.length; a += 1) r[a].keyUpCallback.push(n[i]); else if ("keydown" === t) for (a = 0; a < r.length; a += 1) r[a].keyDownCallback.push(n[i]); return e.clear = s, e } var a, h, c, i = {}, r = []; for ("string" == typeof t && (t = R(t)), h = 0; h < t.length; h += 1) { if (a = {}, c = S([t[h]]), "string" != typeof c) throw new Error("Failed to bind key combo. The key combo must be string."); a.keyCombo = c, a.keyDownCallback = [], a.keyUpCallback = [], e && a.keyDownCallback.push(e), n && a.keyUpCallback.push(n), s.push(a), r.push(a) } return i.clear = u, i.on = l, i } function C(t) { var e, n; for (e = 0; e < s.length; e += 1) n = s[e], k(t, n.keyCombo) && (s.splice(e, 1), e -= 1) } function T(t) { var e, n, i; if (t) { for (e = 0; e < s.length; e += 1) for (i = s[e], n = 0; n < i.keyCombo.length; n += 1) if (i.keyCombo[n].indexOf(t) > -1) { s.splice(e, 1), e -= 1; break } } else s = [] } function I(t) { var e, n, i, a, h, c, u, l, f, d, g, p = []; for (h = [].concat(r), e = 0; e < s.length; e += 1) g = O(s[e].keyCombo).length, p[g] || (p[g] = []), p[g].push(s[e]); for (n = p.length - 1; n >= 0; n -= 1) if (p[n]) for (e = 0; e < p[n].length; e += 1) { for (i = p[n][e], a = O(i.keyCombo), f = !0, l = 0; l < a.length; l += 1) if (-1 === h.indexOf(a[l])) { f = !1; break } if (f && A(i.keyCombo)) { for (o.push(i), l = 0; l < a.length; l += 1) d = h.indexOf(a[l]), d > -1 && (h.splice(d, 1), l -= 1); for (c = 0; c < i.keyDownCallback.length; c += 1) i.keyDownCallback[c](t, X(), i.keyCombo) === !1 && (u = !0); u === !0 && (t.preventDefault(), t.stopPropagation()) } } } function _(t) { var e, n, i, a; for (e = 0; e < o.length; e += 1) if (i = o[e], A(i.keyCombo) === !1) { for (n = 0; n < i.keyUpCallback.length; n += 1) i.keyUpCallback[n](t, X(), i.keyCombo) === !1 && (a = !0); a === !0 && (t.preventDefault(), t.stopPropagation()), o.splice(e, 1), e -= 1 } } function k(t, e) { var n, i, a; if (t = R(t), e = R(e), t.length !== e.length) return !1; for (n = 0; n < t.length; n += 1) { if (t[n].length !== e[n].length) return !1; for (i = 0; i < t[n].length; i += 1) { if (t[n][i].length !== e[n][i].length) return !1; for (a = 0; a < t[n][i].length; a += 1) if (-1 === e[n][i].indexOf(t[n][i][a])) return !1 } } return !0 } function A(t) { var e, n, i, a, o, h, s = 0; for (t = R(t), e = 0; e < t.length; e += 1) { for (h = !0, s = 0, n = 0; n < t[e].length; n += 1) { for (i = [].concat(t[e][n]), a = s; a < r.length; a += 1) o = i.indexOf(r[a]), o > -1 && (i.splice(o, 1), s = a); if (0 !== i.length) { h = !1; break } } if (h) return !0 } return !1 } function O(t) { var e, n, a = []; for (t = R(t), e = 0; e < t.length; e += 1) for (n = 0; n < t[e].length; n += 1) a = a.concat(t[e][n]); return a } function R(t) { var e = t, n = 0, i = 0, a = !1, r = !1, s = [], o = [], h = [], c = ""; if ("object" == typeof t && "function" == typeof t.push) return t; if ("string" != typeof t) throw new Error('Cannot parse "keyCombo" because its type is "' + typeof t + '". It must be a "string".'); for (; " " === e.charAt(n) ;) n += 1; for (; ;) { if (" " === e.charAt(n)) { for (; " " === e.charAt(n) ;) n += 1; a = !0 } else if ("," === e.charAt(n)) { if (i || r) throw new Error("Failed to parse key combo. Unexpected , at character index " + n + "."); r = !0, n += 1 } else if ("+" === e.charAt(n)) { if (c.length && (h.push(c), c = ""), i || r) throw new Error("Failed to parse key combo. Unexpected + at character index " + n + "."); i = !0, n += 1 } else if (">" === e.charAt(n)) { if (c.length && (h.push(c), c = ""), h.length && (o.push(h), h = []), i || r) throw new Error("Failed to parse key combo. Unexpected > at character index " + n + "."); i = !0, n += 1 } else if (n < e.length - 1 && "!" === e.charAt(n) && (">" === e.charAt(n + 1) || "," === e.charAt(n + 1) || "+" === e.charAt(n + 1))) c += e.charAt(n + 1), i = !1, a = !1, r = !1, n += 2; else { if (!(n < e.length && "+" !== e.charAt(n) && ">" !== e.charAt(n) && "," !== e.charAt(n) && " " !== e.charAt(n))) { n += 1; continue } for ((i === !1 && a === !0 || r === !0) && (c.length && (h.push(c), c = ""), h.length && (o.push(h), h = []), o.length && (s.push(o), o = [])), i = !1, a = !1, r = !1; n < e.length && "+" !== e.charAt(n) && ">" !== e.charAt(n) && "," !== e.charAt(n) && " " !== e.charAt(n) ;) c += e.charAt(n), n += 1 } if (n >= e.length) { c.length && (h.push(c), c = ""), h.length && (o.push(h), h = []), o.length && (s.push(o), o = []); break } } return s } function S(t) { var e, n, i = []; if ("string" == typeof t) return t; if ("object" != typeof t || "function" != typeof t.push) throw new Error("Cannot stringify key combo."); for (e = 0; e < t.length; e += 1) { for (i[e] = [], n = 0; n < t[e].length; n += 1) i[e][n] = t[e][n].join(" + "); i[e] = i[e].join(" > ") } return i.join(" ") } function X() { return [].concat(r) } function D(t) { if (t.match(/\s/)) throw new Error("Cannot add key name " + t + " to active keys because it contains whitespace."); r.indexOf(t) > -1 || r.push(t) } function P(t) { var e = v(t); "91" === e || "92" === e ? r = [] : r.splice(r.indexOf(t), 1) } function Y(t, n) { if ("string" != typeof t) throw new Error("Cannot register new locale. The locale name must be a string."); if ("object" != typeof n) throw new Error("Cannot register " + t + " locale. The locale map must be an object."); if ("object" != typeof n.map) throw new Error("Cannot register " + t + " locale. The locale map is invalid."); n.macros || (n.macros = []), e[t] = n } function F(t) { if (t) { if ("string" != typeof t) throw new Error("Cannot set locale. The locale name must be a string."); if (!e[t]) throw new Error("Cannot set locale to " + t + " because it does not exist. If you would like to submit a " + t + " locale map for KeyboardJS please submit it at https://github.com/RobertWHurst/KeyboardJS/issues."); i = e[t].map, a = e[t].macros, n = t } return n } var n, i, a, c, u, t = {}, e = {}, r = [], s = [], o = [], h = []; for (u = { map: { 3: ["cancel"], 8: ["backspace"], 9: ["tab"], 12: ["clear"], 13: ["enter"], 16: ["shift"], 17: ["ctrl"], 18: ["alt", "menu"], 19: ["pause", "break"], 20: ["capslock"], 27: ["escape", "esc"], 32: ["space", "spacebar"], 33: ["pageup"], 34: ["pagedown"], 35: ["end"], 36: ["home"], 37: ["left"], 38: ["up"], 39: ["right"], 40: ["down"], 41: ["select"], 42: ["printscreen"], 43: ["execute"], 44: ["snapshot"], 45: ["insert", "ins"], 46: ["delete", "del"], 47: ["help"], 91: ["command", "windows", "win", "super", "leftcommand", "leftwindows", "leftwin", "leftsuper"], 92: ["command", "windows", "win", "super", "rightcommand", "rightwindows", "rightwin", "rightsuper"], 145: ["scrolllock", "scroll"], 186: ["semicolon", ";"], 187: ["equal", "equalsign", "="], 188: ["comma", ","], 189: ["dash", "-"], 190: ["period", "."], 191: ["slash", "forwardslash", "/"], 192: ["graveaccent", "`"], 219: ["openbracket", "["], 220: ["backslash", "\\"], 221: ["closebracket", "]"], 222: ["apostrophe", "'"], 48: ["zero", "0"], 49: ["one", "1"], 50: ["two", "2"], 51: ["three", "3"], 52: ["four", "4"], 53: ["five", "5"], 54: ["six", "6"], 55: ["seven", "7"], 56: ["eight", "8"], 57: ["nine", "9"], 96: ["numzero", "num0"], 97: ["numone", "num1"], 98: ["numtwo", "num2"], 99: ["numthree", "num3"], 100: ["numfour", "num4"], 101: ["numfive", "num5"], 102: ["numsix", "num6"], 103: ["numseven", "num7"], 104: ["numeight", "num8"], 105: ["numnine", "num9"], 106: ["nummultiply", "num*"], 107: ["numadd", "num+"], 108: ["numenter"], 109: ["numsubtract", "num-"], 110: ["numdecimal", "num."], 111: ["numdivide", "num/"], 144: ["numlock", "num"], 112: ["f1"], 113: ["f2"], 114: ["f3"], 115: ["f4"], 116: ["f5"], 117: ["f6"], 118: ["f7"], 119: ["f8"], 120: ["f9"], 121: ["f10"], 122: ["f11"], 123: ["f12"] }, macros: [["shift + `", ["tilde", "~"]], ["shift + 1", ["exclamation", "exclamationpoint", "!"]], ["shift + 2", ["at", "@"]], ["shift + 3", ["number", "#"]], ["shift + 4", ["dollar", "dollars", "dollarsign", "$"]], ["shift + 5", ["percent", "%"]], ["shift + 6", ["caret", "^"]], ["shift + 7", ["ampersand", "and", "&"]], ["shift + 8", ["asterisk", "*"]], ["shift + 9", ["openparen", "("]], ["shift + 0", ["closeparen", ")"]], ["shift + -", ["underscore", "_"]], ["shift + =", ["plus", "+"]], ["shift + (", ["opencurlybrace", "opencurlybracket", "{"]], ["shift + )", ["closecurlybrace", "closecurlybracket", "}"]], ["shift + \\", ["verticalbar", "|"]], ["shift + ;", ["colon", ":"]], ["shift + '", ["quotationmark", '"']], ["shift + !,", ["openanglebracket", "<"]], ["shift + .", ["closeanglebracket", ">"]], ["shift + /", ["questionmark", "?"]]] }, c = 65; 90 >= c; c += 1) u.map[c] = String.fromCharCode(c + 32), u.macros.push(["shift + " + String.fromCharCode(c + 32) + ", capslock + " + String.fromCharCode(c + 32), [String.fromCharCode(c)]]); Y("us", u), F("us"), l(), t.enable = l, t.disable = f, t.activeKeys = X, t.releaseKey = P, t.pressKey = D, t.on = E, t.clear = C, t.clear.key = T, t.locale = F, t.locale.register = Y, t.macro = w, t.macro.remove = y, t.key = {}, t.key.name = m, t.key.code = v, t.combo = {}, t.combo.active = A, t.combo.parse = R, t.combo.stringify = S, this.Keyboard = t }, on: function (t, e, n) { this.Keyboard.on(t, e, n) }, getActiveKeys: function () { return this.Keyboard.activeKeys() } } }), t.Sprite = t.DisplayObject.extend({ ctor: function (e) { this._super(), this.option = e, this.x = e.x || 0, this.y = e.y || 0, this.currentFrameIndex = 0, this.animationFrameIndex = 0, this.currentAnimation = e.currentAnimation || null, this.rect = [0, 0, 10, 10], this.visible = !1, this.bitmaps = [], this._loadedCount = 0; for (var i = this.option.imgs.length, a = 0; i > a; a++) { var r = this.option.imgs[a]; if ("string" == typeof r) if (t.Bitmap[r]) this.bitmaps.push(new t.Bitmap(t.Bitmap[r])), this._loadedCount++; else { var s = new t.Bitmap; s._sprite = this, s.onImageLoad(function () { s._sprite._loadedCount++, s._sprite._loadedCount === i && (s._sprite.visible = !0, delete s._sprite) }), s.useImage(this.option.imgs[a]), this.bitmaps.push(s) } else this._loadedCount++, this.bitmaps.push(new t.Bitmap(r)) } this._loadedCount === i && (this.visible = !0), this.img = this.bitmaps[0].img, this.interval = 1e3 / e.framerate, this.loop = null, this.paused = !1, this.animationEnd = e.animationEnd || null, this.currentAnimation && this.gotoAndPlay(this.currentAnimation), this.tickAnimationEnd = e.tickAnimationEnd || null }, play: function () { this.paused = !1 }, stop: function () { this.paused = !0 }, reset: function () { this.currentFrameIndex = 0, this.animationFrameIndex = 0 }, gotoAndPlay: function (t, e) { this.paused = !1, this.reset(), clearInterval(this.loop), this.currentAnimation = t; var n = this, i = 0; this.loop = setInterval(function () { if (!n.paused) { var t = n.option, a = t.animations[n.currentAnimation].frames, r = a.length; n.animationFrameIndex++, n.animationFrameIndex > r - 1 && (i++, n.animationFrameIndex = 0, n.tickAnimationEnd && n.tickAnimationEnd(), e && i == e && (n.animationEnd && n.animationEnd(), n.paused = !0, clearInterval(n.loop), n.parent.remove(n))), n.rect = t.frames[a[n.animationFrameIndex]]; var s = n.rect, o = s.length; o > 4 && (n.regX = s[2] * s[4]), o > 5 && (n.regY = s[3] * s[5]), o > 6 && (n.img = n.bitmaps[s[6]].img) } }, this.interval) }, gotoAndStop: function (t) { this.reset(), clearInterval(this.loop); var e = this; e.currentAnimation = t; { var n = e.option, i = n.animations[e.currentAnimation].frames; i.length } e.rect = n.frames[i[e.animationFrameIndex]]; var r = e.rect, s = r.length; s > 4 && (e.regX = r[2] * r[4]), s > 5 && (e.regY = r[3] * r[5]), s > 6 && (e.img = e.bitmaps[r[6]].img) } }), t.Observable = i.extend({ statics: { ctor: function () { this.methods = ["concat", "every", "filter", "forEach", "indexOf", "join", "lastIndexOf", "map", "pop", "push", "reduce", "reduceRight", "reverse", "shift", "slice", "some", "sort", "splice", "unshift", "valueOf"], this.triggerStr = ["concat", "pop", "push", "reverse", "shift", "sort", "splice", "unshift"].join(",") }, type: function (t) { var e = Object.prototype.toString.call(t).split(" ")[1]; return e.substr(0, e.length - 1).toLowerCase() }, isArray: function (t) { return "array" == this.type(t) }, isInArray: function (t, e) { for (var n = t.length; --n > -1;) if (e === t[n]) return !0; return !1 }, isFunction: function (t) { return "function" == this.type(t) }, watch: function (t, e) { return new this(t, e) } }, ctor: function (e, n) { for (var i in e) e.hasOwnProperty(i) && (n && t.Observable.isInArray(n, i) || !n) && this.watch(e, i); if (e.change) throw "naming conflicts！observable will extend 'change' method to your object ."; var a = this; e.change = function (t) { a.propertyChangedHandler = t } }, onPropertyChanged: function (t, e) { this.propertyChangedHandler && this.propertyChangedHandler(t, e) }, mock: function (e) { var n = this; t.Observable.methods.forEach(function (i) { e[i] = function () { var e = Array.prototype[i].apply(this, Array.prototype.slice.call(arguments)); for (var a in this) this.hasOwnProperty(a) && "_super" != a && !t.Observable.isFunction(this[a]) && n.watch(this, a); return new RegExp("\\b" + i + "\\b").test(t.Observable.triggerStr) && n.onPropertyChanged("array", i), e } }) }, watch: function (e, n) { if ("__" != n.substr(0, 2)) { var i = this; if (!t.Observable.isFunction(e[n])) { var a = e["__" + n] = e[n]; if (Object.defineProperty(e, n, { get: function () { return this["__" + n] }, set: function (t) { this["__" + n] = t, i.onPropertyChanged(n, t) } }), t.Observable.isArray(e) && this.mock(e), "object" == typeof a) { t.Observable.isArray(a) && this.mock(a); for (var r in a) a.hasOwnProperty(r) && "_super" != r && this.watch(a, r) } } } } }), new e.Main
            }()
        }(Function("return this")());
    </script>
</body>
</html>
